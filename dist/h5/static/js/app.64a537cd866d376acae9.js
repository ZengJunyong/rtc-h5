webpackJsonp([1],{"/5hJ":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("7+uW"),i=o("8+8L"),n=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)};n._withStripped=!0;var r={render:n,staticRenderFns:[]},s=r;var l=!1;var c=o("VU/8")({name:"App"},s,!1,function(e){l||o("HnCy")},null,null);c.options.__file="src/_start/h5/App.vue";var u=c.exports,d=o("/ocq"),m=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"container"},[o("h1",[e._v("视频会议系统")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.room,expression:"room"}],attrs:{type:"number",placeholder:"请输入房间号",required:""},domProps:{value:e.room},on:{input:function(t){t.target.composing||(e.room=t.target.value)}}}),e._v(" "),o("button",{staticClass:"join",on:{click:e.enterRoom}},[e._v("创建/加入房间")])])};m._withStripped=!0;var p={render:m,staticRenderFns:[]},v=p;var f=!1;var h=o("VU/8")({name:"index",data:function(){return{room:"123"}},methods:{enterRoom:function(){this.$router.push({name:"room",query:{room:this.room}})}}},v,!1,function(e){f||o("EIJB")},"data-v-47323bf2",null);h.options.__file="src/components/index.vue";var g=h.exports,_=o("mvHQ"),y=o.n(_);function w(){var e=window.navigator.userAgent,t=void 0!=window.ActiveXObject&&-1!=e.indexOf("MSIE"),o=-1!=e.indexOf("Firefox"),a=void 0!=window.opr,i=e.indexOf("Chrome")&&window.chrome,n=-1!=e.indexOf("Safari")&&-1!=e.indexOf("Version");return t?"IE":o?"Firefox":a?"Opera":i?"Chrome":n?"Safari":"Unkown"}function C(){S.enumDevices(function(e){console.log("enumDevices",e),O=e},function(e){console.error("enum device error: "+e)})}var S,b,x,A,V,P,O,k,M,R={appid:3104114736,idName:"v"+(new Date).getTime(),idAudioName:"a"+(new Date).getTime(),nickName:"u"+(new Date).getTime(),server:"wss://wsliveroom3104114736-api.zego.im:8282/ws",logLevel:2,logUrl:"",remoteLogLevel:0,audienceCreateRoom:!0},N={cgi_token:"",roomlist:"",signal:"",token:"https://wsliveroom-demo.zego.im:8282/token"},I=!1,E=!1,F=[],U=[];function $(){(S=new ZegoClient).setUserStateUpdate(!0),console.log(R),S.config(R),C(),function(){var e={onStreamUpdated:function(e,t){if(console.log("onStreamUpdated",e,t),0==e){for(var o=F.length,a=U.length,i=0,n=0;n<t.length;n++)console.info(t[n].stream_id+" was added"),"v"===t[n].stream_id.charAt(0)?(F.push(t[n]),D(t[n].stream_id,A[o+n]),i++):(U.push(t[n]),J(t[n].stream_id,V[a+n]));M(o+i)}else if(1==e){for(var r=!1,s=0;s<F.length;s++)for(var l=0;l<t.length;l++)if(F[s].stream_id===t[l].stream_id){S.stopPlayingStream(F[s].stream_id),console.info(F[s].stream_id+" was devared"),F.splice(s,1),r=!0;break}r&&z();var c=!1;for(s=0;s<U.length;s++)for(l=0;l<t.length;l++)if(U[s].stream_id===t[l].stream_id){S.stopPlayingStream(U[s].stream_id),console.info(U[s].stream_id+" was devared"),U.splice(s,1),c=!0;break}c&&q()}}};for(var t in e)S[t]=e[t]}()}function z(){for(var e=F.length,t=0;t<e;t++)S.stopPlayingStream(F[t].stream_id);for(var o=0;o<e;o++)D(F[o].stream_id,A[o]);M(e)}function q(){for(var e=U.length,t=0;t<e;t++)S.stopPlayingStream(U[t].stream_id);for(var o=0;o<e;o++)J(U[o].stream_id,V[o])}function Z(e){var t={audio:!0,audioInput:O.microphones[0].deviceId||null,video:!0,videoInput:O.cameras[0].deviceId||null,videoQuality:2,horizontal:!0,externalCapture:!1,externalMediaStream:null};t=a.a.util.extend(t,e),console.log("previewConfig",t),S.startPreview(b,t,function(){console.log("preview success"),k(),E=!0,S.startPublishingStream(R.idName,b),C()},function(e){alert(y()(e)),console.error("preview failed",e)})||alert("预览失败！")}function j(e){var t={audio:!0,audioInput:O.microphones[0].deviceId||null,video:!1,videoInput:O.cameras[0].deviceId||null,videoQuality:2,horizontal:!0,externalCapture:!1,externalMediaStream:null};t=a.a.util.extend(t,e),console.log("previewConfig",t),(x=document.getElementById("screenAudio")).muted=!0,S.startPreview(x,t,function(){console.log("preview audio success"),S.startPublishingStream(R.idAudioName,x)},function(e){alert(y()(e)),console.error("preview failed",e)})||alert("预览失败！")}function D(e,t){var o=S.startPlayingStream(e,t);t.muted=!1,o||(alert("哎呀，播放失败啦"),t.style="display:none")}function J(e,t){var o=S.startPlayingStream(e,t,null,{playType:"audio"});t.muted=!1,o||(alert("哎呀，播放失败啦"),t.style="display:none")}var T=function(){for(var e=navigator.userAgent,t=new Array("Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"),o=!0,a=0;a<t.length;a++)if(e.indexOf(t[a])>0){o=!1;break}return o}()&&("Chrome"===w()||"Firefox"===w());console.log("sdk version is",ZegoClient.getCurrentVersion()),ZegoClient.isSupportWebrtc()?ZegoClient.isSupportH264(function(e){$(),e||alert("浏览器不支持视频h264编码，不能推拉音频流")},function(e){console.error(e)}):alert("浏览器不支持webrtc，换一个浏览器试试吧");var W={zg:S,openRoom:function(e,t,o,i,n,r,s){b=o,A=i,V=n,k=r,M=s,e?(P&&S.stopScreenShot(),a.a.http.get(N.token,{params:{app_id:R.appid,id_name:R.idName,cgi_token:N.cgi_token}}).then(function(o){console.log("gettoken success"),function(e,t,o){S.login(e,o,t,function(e){console.log("login success"),function(e,t){if(e.length>=20)return alert("房间太拥挤，换一个吧！"),void function(){console.info("leave room  and close stream"),E&&(S.stopPreview(b),S.stopPublishingStream(R.idName),E=!1);for(var e=0;e<F.length;e++)S.stopPlayingStream(F[e].stream_id);for(e=0;e<U.length;e++)S.stopPlayingStream(U[e].stream_id);F=[],U=[],S.logout()}();e.forEach(function(e){"v"===e.stream_id.charAt(0)?F.push(e):U.push(e)}),z(),q(),console.log("login success"),I=!0,1===t&&Z()}(e,o)},function(e){!function(e){alert("登录失败"),console.error(e)}(e)})}(e,o.data,t)})):alert("请输入房间号")},enableCamera:function(e){S.enableCamera(b,e)},enableMicrophone:function(e){S.enableMicrophone(b,e)},isSupportShareScreen:T,enableScreen:function(e){e?(I&&S.stopPublishingStream(R.idName),I&&S.stopPreview(b),"Firefox"===w()&&S.startScreenShotFirFox("window",!1,function(e,t){console.log("startScreenShot:"+e),P=e,b.srcObject=t,I&&(Z({externalMediaStream:null,width:640,height:480,frameRate:15,bitRate:1e3}),j({audio:!1}))}),"Chrome"===w()&&S.startScreenShotChrome(function(e,t){console.log("startScreenShot:"+e),P=e,b.srcObject=t,I&&(Z({externalCapture:!0,audio:!1}),j())})):(S.stopScreenShot(),S.stopPreview(b),S.stopPublishingStream(R.idName),Z(),S.stopPreview(x),S.stopPublishingStream(R.idAudioName))}},B={name:"room",data:function(){return{previewVideo:!1,remoteVideo:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],lengthOfRemoteVideo:0,enableCamera:!0,enableMic:!0,enableScreen:!1}},mounted:function(){var e=this;W.openRoom(this.$route.query.room,1,document.getElementById("previewVideo"),document.querySelectorAll(".remoteVideo"),document.querySelectorAll(".remoteAudio"),function(){e.previewVideo=!0},function(t){e.lengthOfRemoteVideo=t;for(var o=0;o<e.remoteVideo.length;o++)e.remoteVideo.splice(o,1,o<t)})},methods:{toggleCamera:function(){this.enableCamera=!this.enableCamera,W.enableCamera(this.enableCamera)},toggleMic:function(){this.enableMic=!this.enableMic,W.enableMicrophone(this.enableMic)},toggleScreen:function(){W.isSupportShareScreen?(this.enableScreen=!this.enableScreen,W.enableScreen(this.enableScreen)):alert("屏幕分享功能只支持桌面系统的Chrome或者Firefox浏览器")}}},H=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"container flex"},[o("div",{staticClass:"room",class:e.lengthOfRemoteVideo<=3?"":"scroll"},[o("div",{staticClass:"video flex-center",class:e.previewVideo?"":"opacity55"},[o("video",{directives:[{name:"show",rawName:"v-show",value:e.previewVideo,expression:"previewVideo"}],attrs:{id:"previewVideo",muted:"",autoplay:"",playsinline:"",controls:""},domProps:{muted:!0}}),e._v(" "),o("img",{directives:[{name:"show",rawName:"v-show",value:!e.previewVideo,expression:"!previewVideo"}],attrs:{src:"static/roomset_1.png",alt:""}})]),e._v(" "),e._l(e.remoteVideo,function(t,a){return o("div",{directives:[{name:"show",rawName:"v-show",value:e.lengthOfRemoteVideo<=3?a<3:a<e.lengthOfRemoteVideo,expression:"lengthOfRemoteVideo<=3? i<3: i<lengthOfRemoteVideo"}],staticClass:"video flex-center",class:t?"":"opacity55"},[o("video",{directives:[{name:"show",rawName:"v-show",value:t,expression:"r"}],staticClass:"remoteVideo",attrs:{autoplay:"",playsinline:"",controls:""}}),e._v(" "),o("img",{directives:[{name:"show",rawName:"v-show",value:!t,expression:"!r"}],attrs:{src:"static/roomset_"+(a+2)+".png",alt:""}})])})],2),e._v(" "),o("div",{staticClass:"bottom"},[o("div",{staticClass:"flex-center"},[o("img",{attrs:{src:"static/camera"+(e.enableCamera?"-dis":"")+".png",alt:""},on:{click:e.toggleCamera}})]),e._v(" "),o("div",{staticClass:"flex-center"},[o("img",{attrs:{src:"static/mic"+(e.enableMic?"-dis":"")+".png",alt:""},on:{click:e.toggleMic}})]),e._v(" "),o("div",{staticClass:"flex-center"},[o("img",{attrs:{src:"static/screen"+(e.enableScreen?"-dis":"")+".png",alt:""},on:{click:e.toggleScreen}})]),e._v(" "),e._m(0)])])};H._withStripped=!0;var L={render:H,staticRenderFns:[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"none"},[o("audio",{attrs:{id:"screenAudio",autoplay:"",muted:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}}),e._v(" "),o("audio",{staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}})])}]},G=L;var Q=!1;var X=o("VU/8")(B,G,!1,function(e){Q||o("vZf/")},"data-v-7030392a",null);X.options.__file="src/components/room.vue";var K=X.exports,Y=function(){var e=this.$createElement;this._self._c;return this._m(0)};Y._withStripped=!0;var ee={render:Y,staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"template-view"},[t("button",{staticClass:".btn"},[this._v("Get Method")])])}]},te=ee;var oe=!1;var ae=o("VU/8")({name:"template",components:{},data:function(){return{show:!1}},methods:{}},te,!1,function(e){oe||o("p+W8")},"data-v-2f56c616",null);ae.options.__file="src/pages/test.vue";var ie=ae.exports;a.a.use(d.a);var ne=new d.a({routes:[{path:"/",name:"index",component:g},{path:"/room",name:"room",component:K},{path:"/test",name:"test",component:ie}]});o("MGcz");a.a.config.productionTip=!1,a.a.use(i.a),new a.a({el:"#app",router:ne,components:{App:u},template:"<App/>"})},0:function(e,t){},EIJB:function(e,t){},HnCy:function(e,t){},MGcz:function(e,t){},"p+W8":function(e,t){},"vZf/":function(e,t){}},["/5hJ"]);
//# sourceMappingURL=app.64a537cd866d376acae9.js.map