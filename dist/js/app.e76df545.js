(function(e){function t(t){for(var o,a,s=t[0],c=t[1],l=t[2],d=0,m=[];d<s.length;d++)a=s[d],r[a]&&m.push(r[a][0]),r[a]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);u&&u(t);while(m.length)m.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(o=!1)}o&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},r={app:0},i=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var o=n("f792"),r=n.n(o);r.a},"0bc5":function(e,t,n){"use strict";var o=n("c9e7"),r=n.n(o);r.a},"217f":function(e){e.exports={url:"https://zjy.urer.top/-api"}},"2b33":function(e,t,n){"use strict";var o=3104114736;e.exports={appid:o,_config:{appid:o,idName:"v"+(new Date).getTime(),idAudioName:"a"+(new Date).getTime(),nickName:"u"+(new Date).getTime(),server:"wss://wsliveroom"+o+"-api.zego.im:8282/ws",logLevel:2,logUrl:"",remoteLogLevel:0,audienceCreateRoom:!0},_otherConfig:{cgi_token:"",roomlist:"",signal:"",token:"https://wsliveroom-demo.zego.im:8282/token"}}},"56d7":function(e,t,n){"use strict";n.r(t);n("5c07"),n("53da"),n("2556"),n("d0f8");var o=n("2418"),r=n("7f43"),i=n.n(r),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},s=[],c={name:"App"},l=c,u=(n("034f"),n("17cc")),d=Object(u["a"])(l,a,s,!1,null,null,null),m=d.exports,f=n("081a"),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"center"},[n("div",{staticClass:"container"},[n("div",{attrs:{id:"div1"}}),e._m(0),n("div",{staticClass:"flex"},[n("div",[n("div",[e._m(1),n("input",{directives:[{name:"model",rawName:"v-model",value:e.room,expression:"room"}],attrs:{type:"number",placeholder:"会议编号",required:""},domProps:{value:e.room},on:{input:function(t){t.target.composing||(e.room=t.target.value)}}}),n("p",{class:e.validate?"":"error"},[e._v("会议编号是6位数字")]),n("div",{staticClass:"btn pointer",on:{click:e.joinRoom}},[e._v("加入")])])]),n("div",[n("div",[e._m(2),n("div",{staticClass:"radio",staticStyle:{"margin-top":"23px"}},[n("label",{staticClass:"radio-container"},[e._v("\n                            视频开启\n                            "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.video,expression:"video"}],attrs:{type:"radio",value:"1"},domProps:{checked:e._q(e.video,"1")},on:{change:function(t){e.video="1"}}}),n("span",{staticClass:"checkmark"})])]),n("div",{staticClass:"radio",staticStyle:{margin:"15px 0 23px 0"}},[n("label",{staticClass:"radio-container"},[e._v("\n                            视频关闭\n                            "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.video,expression:"video"}],attrs:{type:"radio",value:"0"},domProps:{checked:e._q(e.video,"0")},on:{change:function(t){e.video="0"}}}),n("span",{staticClass:"checkmark"})])]),n("div",{staticClass:"btn pointer",on:{click:e.createRoom}},[e._v("发起")])])])]),e._m(3)])])},v=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex-center logo"},[n("iframe",{attrs:{src:"static/logo.svg",width:"65",height:"66"}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"btn _1"},[e._v("\n                        加入一场会议\n                        "),n("div",{staticClass:"attachment"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"btn _2"},[e._v("\n                        发起一场会议\n                        "),n("div",{staticClass:"attachment"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex-center"},[n("div",{staticClass:"footer"},[e._v("\n                优客工场·U会议\n                "),n("br"),e._v("UCOMMUNE\n            ")])])}],h=(n("b5aa"),n("2c46")),g=n("217f"),b={name:"index",data:function(){return{room:"",video:1,validate:!0}},computed:{isSafariOnIphone:function(){var e=window.navigator.userAgent;return-1!=e.indexOf("Safari")&&-1!=e.indexOf("Version")&&-1!=e.indexOf("iPhone")}},methods:{joinRoom:function(){var e=Object(h["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=/^^[1-9]\d{5}$$/,!t.test(this.room)){e.next=10;break}return e.next=4,this.$http.get("".concat(g.url,"/conference/isRoomExist"),{params:{roomID:this.room}});case 4:if(n=e.sent,n.data){e.next=7;break}return e.abrupt("return",alert("该会议编号（".concat(this.room,"）不存在，请检查一下是否有误？")));case 7:this.$router.push({name:"room",query:{room:this.room},params:{isSafariOnIphone:this.isSafariOnIphone}}),e.next=11;break;case 10:this.validate=!1;case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),createRoom:function(){var e=Object(h["a"])(regeneratorRuntime.mark(function e(){var t,n,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=!0;case 1:if(!n){e.next=10;break}if(t=Math.floor(1e6*Math.random()),!(t>1e5)){e.next=8;break}return e.next=6,this.$http.get("".concat(g.url,"/conference/isRoomExist"),{params:{roomID:t}});case 6:o=e.sent,o.data||(n=!1);case 8:e.next=1;break;case 10:this.$http.post("".concat(g.url,"/conference/addRoom"),{roomID:t,userID:1}),this.$router.push({name:"room",query:{room:t,video:this.video},params:{isSafariOnIphone:this.isSafariOnIphone}});case 12:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},w=b,_=(n("0bc5"),Object(u["a"])(w,p,v,!1,null,"f2bcd830",null)),S=_.exports,y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container flex"},[n("div",{staticClass:"room",class:e.lengthOfRemoteVideo<=3?"":"scroll"},[n("div",{staticClass:"video flex-center",class:e.previewVideo?"":"opacity55"},[n("video",{directives:[{name:"show",rawName:"v-show",value:e.previewVideo,expression:"previewVideo"}],attrs:{id:"previewVideo",muted:"",autoplay:"",playsinline:"",controls:""},domProps:{muted:!0}})]),e._l(e.remoteVideo,function(t,o){return n("div",{directives:[{name:"show",rawName:"v-show",value:o<e.lengthOfRemoteVideo,expression:"i<lengthOfRemoteVideo"}],key:o,staticClass:"video flex-center",class:t?"":"opacity55"},[n("video",{directives:[{name:"show",rawName:"v-show",value:t,expression:"r"}],staticClass:"remoteVideo",attrs:{autoplay:"",playsinline:"",controls:""}})])})],2),n("div",{staticClass:"bottom"},[n("div",[n("div",{on:{click:e.toggleCamera}},[n("img",{attrs:{src:"static/camera.png",alt:""}}),n("div",{staticClass:"circle"},[n("i",{class:e.enableCamera?"green":"red"}),e._v("\n                    "+e._s(e.enableCamera?"关闭视频":"开启视频")+"\n                ")])]),n("div",{on:{click:e.toggleMic}},[n("img",{attrs:{src:"static/mic.png",alt:""}}),n("div",{staticClass:"circle"},[n("i",{class:e.enableMic?"green":"red"}),e._v("\n                    "+e._s(e.enableMic?"关闭声音":"开启声音")+"\n                ")])]),e.isSupportShareScreen?n("div",{on:{click:e.toggleScreen}},[n("img",{attrs:{src:"static/screen"+(e.enableScreen?"-dis":"")+".png",alt:""}}),e._v("\n                "+e._s(e.enableScreen?"关闭分享":"屏幕分享")+"\n            ")]):e._e()]),n("div",[n("div",{on:{click:e.copyToClipboard}},[n("img",{attrs:{src:"static/link.png",alt:""}}),e._v("\n                复制链接\n            ")]),n("div",{staticClass:"red",on:{click:function(t){return e.endMeeting()}}},[n("img",{attrs:{src:"static/end-meeting.png",alt:""}}),e._v("\n                结束会议\n            ")]),n("div",[n("span",{staticClass:"flex-center"},[e._v(e._s(e.room))]),e._v("\n                会议编号\n            ")])]),n("div",{staticClass:"none"},[n("audio",{attrs:{id:"screenAudio",autoplay:"",muted:"",playsinline:""}}),e._l(e.remoteVideo,function(e,t){return n("audio",{key:t,staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}})})],2)])])},C=[],x=n("f46d"),k=n.n(x),O=(n("612f"),n("2b33"));function P(){var e=window.navigator.userAgent,t=void 0!=window.ActiveXObject&&-1!=e.indexOf("MSIE"),n=-1!=e.indexOf("Firefox"),o=void 0!=window.opr,r=e.indexOf("Chrome")&&window.chrome,i=-1!=e.indexOf("Safari")&&-1!=e.indexOf("Version");return t?"IE":n?"Firefox":o?"Opera":r?"Chrome":i?"Safari":"Unkown"}function M(){for(var e=navigator.userAgent,t=new Array("Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"),n=!0,o=0;o<t.length;o++)if(e.indexOf(t[o])>0){n=!1;break}return n}function R(){V.enumDevices(function(e){console.log("enumDevices",e),E=e},function(e){console.error("enum device error: "+e)})}var V,A,I,j,$,N,E,D,q,T=O._config,U=O._otherConfig,F=!1,z=!1,Z=[],B=[];function L(){console.info("leave room  and close stream"),z&&(V.stopPreview(A),V.stopPublishingStream(T.idName),z=!1);for(var e=0;e<Z.length;e++)V.stopPlayingStream(Z[e].stream_id);for(var t=0;t<B.length;t++)V.stopPlayingStream(B[t].stream_id);Z=[],B=[],V.logout()}function J(){var e={onStreamUpdated:function(e,t){if(console.log("onStreamUpdated",e,t),0==e){for(var n=Z.length,o=B.length,r=0,i=0,a=0;a<t.length;a++)console.info(t[a].stream_id+" was added"),"v"===t[a].stream_id.charAt(0)?(Z.push(t[a]),re(t[a].stream_id,j[n+r]),r++):(B.push(t[a]),ie(t[a].stream_id,$[o+i]),i++);q(n+r)}else if(1==e){for(var s=!1,c=0;c<Z.length;c++)for(var l=0;l<t.length;l++)if(Z[c].stream_id===t[l].stream_id){V.stopPlayingStream(Z[c].stream_id),console.info(Z[c].stream_id+" was devared"),Z.splice(c,1),s=!0;break}s&&G();for(var u=!1,d=0;d<B.length;d++)for(var m=0;m<t.length;m++)if(B[d].stream_id===t[m].stream_id){V.stopPlayingStream(B[d].stream_id),console.info(B[d].stream_id+" was devared"),B.splice(d,1),u=!0;break}u&&K()}}};for(var t in e)V[t]=e[t]}function Q(){V=new window.ZegoClient,V.setUserStateUpdate(!0),console.log(T),V.config(T),R(),J()}function W(e,t,n,o,r,a,s){A=n,j=o,$=r,D=a,q=s,e?(N&&V.stopScreenShot(),i.a.get(U.token,{params:{app_id:T.appid,id_name:T.idName,cgi_token:U.cgi_token}}).then(function(n){console.log("gettoken success"),H(e,n.data,t)})):alert("请输入房间号")}function H(e,t,n){V.login(e,n,t,function(e){console.log("login success"),Y(e,n)},function(e){X(e)})}function X(e){alert("登录失败"),console.error(e)}function G(){for(var e=Z.length,t=0;t<e;t++)V.stopPlayingStream(Z[t].stream_id);for(var n=0;n<e;n++)re(Z[n].stream_id,j[n]);q(e)}function K(){for(var e=B.length,t=0;t<e;t++)V.stopPlayingStream(B[t].stream_id);for(var n=0;n<e;n++)ie(B[n].stream_id,$[n])}function Y(e,t){var n=20;if(e.length>=n)return alert("房间太拥挤，换一个吧！"),void L();e.forEach(function(e){"v"===e.stream_id.charAt(0)?Z.push(e):B.push(e)}),G(),K(),console.log("login success"),F=!0,1===t&&ee()}function ee(e){var t=2,n={audio:!0,audioInput:E.microphones[0].deviceId||null,video:!0,facingMode:"user",videoQuality:1*t,horizontal:!0,externalCapture:!1,externalMediaStream:null};n=o["a"].util.extend(n,e),console.log("previewConfig",n);var r=V.startPreview(A,n,function(){console.log("preview success"),D(),z=!0,ne(),R()},function(e){alert(k()(e)),console.error("preview failed",e)});r||alert("预览失败！")}function te(e){var t=2,n={audio:!0,audioInput:E.microphones[0].deviceId||null,video:!1,videoInput:E.cameras[0].deviceId||null,videoQuality:1*t,horizontal:!0,externalCapture:!1,externalMediaStream:null};n=o["a"].util.extend(n,e),console.log("previewConfig",n),I=document.getElementById("screenAudio"),I.muted=!0;var r=V.startPreview(I,n,function(){console.log("preview audio success"),oe()},function(e){alert(k()(e)),console.error("preview failed",e)});r||alert("预览失败！")}function ne(){V.startPublishingStream(T.idName,A)}function oe(){V.startPublishingStream(T.idAudioName,I)}function re(e,t){var n=V.startPlayingStream(e,t);t.muted=!1,n||(alert("哎呀，播放失败啦"),t.style="display:none")}function ie(e,t){var n=V.startPlayingStream(e,t,null,{playType:"audio"});t.muted=!1,n||(alert("哎呀，播放失败啦"),t.style="display:none")}function ae(e){V.enableCamera(A,e)}function se(e){V.enableMicrophone(A,e)}var ce=M()&&("Chrome"===P()||"Firefox"===P());function le(e){e?(F&&V.stopPublishingStream(T.idName),F&&V.stopPreview(A),"Firefox"===P()&&V.startScreenShotFirFox("window",!1,function(e,t){console.log("startScreenShot:"+e),N=e,A.srcObject=t,F&&(ee({externalMediaStream:null,width:640,height:480,frameRate:15,bitRate:1e3}),te({audio:!1}))}),"Chrome"===P()&&V.startScreenShotChrome(function(e,t){console.log("startScreenShot:"+e),N=e,A.srcObject=t,F&&(ee({externalCapture:!0,audio:!1}),te())})):(V.stopScreenShot(),V.stopPreview(A),V.stopPublishingStream(T.idName),ee(),V.stopPreview(I),V.stopPublishingStream(T.idAudioName))}console.log("sdk version is",window.ZegoClient.getCurrentVersion()),window.ZegoClient.isSupportWebrtc()?window.ZegoClient.isSupportH264(function(e){Q(),e||alert("浏览器不支持视频h264编码，不能推拉音频流")},function(e){console.error(e)}):alert("浏览器不支持webrtc，换一个浏览器试试吧");var ue={zg:V,openRoom:W,enableCamera:ae,enableMicrophone:se,isSupportShareScreen:ce,enableScreen:le,leaveRoom:L},de=n("217f"),me={name:"room",data:function(){return{previewVideo:!1,remoteVideo:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],lengthOfRemoteVideo:0,enableCamera:!0,enableMic:!0,enableScreen:!1}},beforeCreate:function(){this.$route.params.isSafariOnIphone&&location.reload(!0)},mounted:function(){var e=this;ue.openRoom(this.room,1,document.getElementById("previewVideo"),document.querySelectorAll(".remoteVideo"),document.querySelectorAll(".remoteAudio"),function(){e.previewVideo=!0,"0"===e.$route.query.video&&e.toggleCamera()},function(t){e.lengthOfRemoteVideo=t;for(var n=0;n<e.remoteVideo.length;n++)e.remoteVideo.splice(n,1,n<t)})},computed:{room:function(){return this.$route.query.room+""},isSupportShareScreen:function(){return ue.isSupportShareScreen}},methods:{toggleCamera:function(){this.enableCamera=!this.enableCamera,ue.enableCamera(this.enableCamera)},toggleMic:function(){this.enableMic=!this.enableMic,ue.enableMicrophone(this.enableMic)},toggleScreen:function(){this.enableScreen=!this.enableScreen,ue.enableScreen(this.enableScreen)},copyToClipboard:function(){var e="您好，快来加入视频会议吧，我在这儿等你："+location.origin+location.pathname+"#/room?room="+this.room,t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),alert("会议的链接已经复制到剪贴板，请通过邮件，微信等发送给他人即可加入该会议。")},endMeeting:function(){ue.leaveRoom(),this.lengthOfRemoteVideo||this.$http.post("".concat(de.url,"/conference/removeRoom"),{roomID:this.room,userID:1}),this.$router.push({name:"index"})}}},fe=me,pe=(n("ea0b"),Object(u["a"])(fe,y,C,!1,null,"6d1cc62f",null)),ve=pe.exports;o["a"].use(f["a"]);var he=new f["a"]({mode:"hash",base:"",routes:[{path:"/",name:"index",component:S},{path:"/room",name:"room",component:ve}]}),ge=n("e1bc");Object(ge["a"])("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});n("e008");o["a"].config.productionTip=!1,o["a"].prototype.$http=i.a,new o["a"]({router:he,render:function(e){return e(m)}}).$mount("#app")},"5c86":function(e,t,n){},c9e7:function(e,t,n){},e008:function(e,t,n){},ea0b:function(e,t,n){"use strict";var o=n("5c86"),r=n.n(o);r.a},f792:function(e,t,n){}});
//# sourceMappingURL=app.e76df545.js.map