webpackJsonp([1],{"/5hJ":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("7+uW"),i=n("8+8L"),r=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)};r._withStripped=!0;var a={render:r,staticRenderFns:[]},s=a;var c=!1;var l=n("VU/8")({name:"App"},s,!1,function(e){c||n("HnCy")},null,null);l.options.__file="src/_start/h5/App.vue";var d=l.exports,m=n("/ocq"),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("h1",[e._v("视频会议系统")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.room,expression:"room"}],attrs:{type:"number",placeholder:"请输入房间号",required:""},domProps:{value:e.room},on:{input:function(t){t.target.composing||(e.room=t.target.value)}}}),e._v(" "),n("button",{staticClass:"join",on:{click:e.enterRoom}},[e._v("创建/加入房间")])])};u._withStripped=!0;var v={render:u,staticRenderFns:[]},p=v;var f=!1;var h=n("VU/8")({name:"index",data:function(){return{room:"123"}},methods:{enterRoom:function(){this.$router.push({name:"room",query:{room:this.room}})}}},p,!1,function(e){f||n("EIJB")},"data-v-47323bf2",null);h.options.__file="src/components/index.vue";var g=h.exports,w=n("mvHQ"),_=n.n(w),S=n("EKMJ");function b(){var e=window.navigator.userAgent,t=void 0!=window.ActiveXObject&&-1!=e.indexOf("MSIE"),n=-1!=e.indexOf("Firefox"),o=void 0!=window.opr,i=e.indexOf("Chrome")&&window.chrome,r=-1!=e.indexOf("Safari")&&-1!=e.indexOf("Version");return t?"IE":n?"Firefox":o?"Opera":i?"Chrome":r?"Safari":"Unkown"}function C(){x.enumDevices(function(e){console.log("enumDevices",e),P=e},function(e){console.error("enum device error: "+e)})}var x,V,y,O,P,M,R,k={appid:3104114736,idName:(new Date).getTime()+"",nickName:"u"+(new Date).getTime(),server:"wss://wsliveroom3104114736-api.zego.im:8282/ws",logLevel:2,logUrl:"",remoteLogLevel:0,audienceCreateRoom:!0},N={cgi_token:"",roomlist:"",signal:"",token:"https://wsliveroom-demo.zego.im:8282/token"},E=!1,A=!1,U=[];function F(){(x=new S.ZegoClient).setUserStateUpdate(!0),x.config(k),C(),function(){var e={onStreamUpdated:function(e,t){if(console.log("onStreamUpdated",e,t),0==e){for(var n=U.length,o=0;o<t.length;o++)console.info(t[o].stream_id+" was added"),U.push(t[o]),z(t[o].stream_id,y[n+o]);R(n+t.length)}else if(1==e){for(var i=0;i<U.length;i++)for(var r=0;r<t.length;r++)if(U[i].stream_id===t[r].stream_id){x.stopPlayingStream(U[i].stream_id),console.info(U[i].stream_id+" was devared"),U.splice(i,1);break}I()}}};for(var t in e)x[t]=e[t]}()}function I(){for(var e=U.length,t=0;t<e;t++)x.stopPlayingStream(U[t].stream_id);for(var n=0;n<e;n++)z(U[n].stream_id,y[n]);R(e)}function $(e){var t={audio:!0,audioInput:P.microphones[0].deviceId||null,video:!0,videoInput:P.cameras[0].deviceId||null,videoQuality:2,horizontal:!0,externalCapture:!1,externalMediaStream:null};t=o.a.util.extend(t,e),console.log("previewConfig",t),x.startPreview(V,t,function(){console.log("preview success"),M(),A=!0,x.startPublishingStream(k.idName,V),C()},function(e){alert(_()(e)),console.error("preview failed",e)})||alert("预览失败！")}function z(e,t){var n=x.startPlayingStream(e,t);t.muted=!1,n||(alert("哎呀，播放失败啦"),t.style="display:none")}console.log("sdk version is",S.ZegoClient.getCurrentVersion()),S.ZegoClient.isSupportWebrtc()?S.ZegoClient.isSupportH264(function(e){F(),e||alert("浏览器不支持视频h264编码，不能推拉音频流")},function(e){console.error(e)}):alert("浏览器不支持webrtc，换一个浏览器试试吧");var J={zg:x,init:F,openRoom:function(e,t,n,i,r,a){V=n,y=i,M=r,R=a,e?(O&&x.stopScreenShot(),o.a.http.get(N.token,{params:{app_id:k.appid,id_name:k.idName,cgi_token:N.cgi_token}}).then(function(n){console.log("gettoken success"),function(e,t,n){x.login(e,n,t,function(e){console.log("login success"),function(e,t){if(e.length>=20)return alert("房间太拥挤，换一个吧！"),void function(){console.info("leave room  and close stream"),A&&(x.stopPreview(V),x.stopPublishingStream(k.idName),A=!1);for(var e=0;e<U.length;e++)x.stopPlayingStream(U[e].stream_id);U=[],x.logout()}();U=e,I(),console.log("login success"),E=!0,1===t&&$()}(e,n)},function(e){!function(e){alert("登录失败"),console.error(e)}(e)})}(e,n.data,t)})):alert("请输入房间号")},enableCamera:function(e){x.enableCamera(V,e)},enableMicrophone:function(e){x.enableMicrophone(V,e)},enableScreen:function(e){if(function(){for(var e=navigator.userAgent,t=new Array("Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"),n=!0,o=0;o<t.length;o++)if(e.indexOf(t[o])>0){n=!1;break}return n}())if(e){E&&x.stopPublishingStream(k.idName),E&&x.stopPreview(V);var t={externalMediaStream:null,width:640,height:480,frameRate:15,bitRate:1e3};"Firefox"===b()&&x.startScreenShotFirFox("window",!1,function(e,n){console.log("startScreenShot:"+e),O=e,V.srcObject=n,E&&$(t)}),"Chrome"===b()&&x.startScreenShotChrome(function(e,t){console.log("startScreenShot:"+e),O=e,V.srcObject=t,E&&$({externalCapture:!0})})}else x.stopScreenShot(),x.stopPreview(V),x.stopPublishingStream(k.idName),$()}},Z={name:"room",data:function(){return{previewVideo:!1,remoteVideo:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],lengthOfRemoteVideo:0,enableCamera:!0,enableMic:!0,enableScreen:!1}},mounted:function(){var e=this;J.init(),J.openRoom(this.$route.query.room,1,document.getElementById("previewVideo"),document.querySelectorAll(".remoteVideo"),function(){e.previewVideo=!0},function(t){e.lengthOfRemoteVideo=t;for(var n=0;n<e.remoteVideo.length;n++)e.remoteVideo.splice(n,1,n<t)})},methods:{toggleCamera:function(){this.enableCamera=!this.enableCamera,J.enableCamera(this.enableCamera)},toggleMic:function(){this.enableMic=!this.enableMic,J.enableMicrophone(this.enableMic)},toggleScreen:function(){this.enableScreen=!this.enableScreen,J.enableScreen(this.enableScreen)}}},j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container flex"},[n("div",{staticClass:"room",class:e.lengthOfRemoteVideo<=3?"":"scroll"},[n("div",{staticClass:"video flex-center",class:e.previewVideo?"":"opacity55"},[n("video",{directives:[{name:"show",rawName:"v-show",value:e.previewVideo,expression:"previewVideo"}],attrs:{id:"previewVideo",muted:"",autoplay:"",playsinline:"",controls:""},domProps:{muted:!0}}),e._v(" "),n("img",{directives:[{name:"show",rawName:"v-show",value:!e.previewVideo,expression:"!previewVideo"}],attrs:{src:"static/roomset_1.png",alt:""}})]),e._v(" "),e._l(e.remoteVideo,function(t,o){return n("div",{directives:[{name:"show",rawName:"v-show",value:e.lengthOfRemoteVideo<=3?o<3:o<e.lengthOfRemoteVideo,expression:"lengthOfRemoteVideo<=3? i<3: i<lengthOfRemoteVideo"}],staticClass:"video flex-center",class:t?"":"opacity55"},[n("video",{directives:[{name:"show",rawName:"v-show",value:t,expression:"r"}],staticClass:"remoteVideo",attrs:{autoplay:"",playsinline:"",controls:""}}),e._v(" "),n("img",{directives:[{name:"show",rawName:"v-show",value:!t,expression:"!r"}],attrs:{src:"static/roomset_"+(o+2)+".png",alt:""}})])})],2),e._v(" "),n("div",{staticClass:"bottom"},[n("div",{staticClass:"flex-center"},[n("img",{attrs:{src:"static/camera"+(e.enableCamera?"":"-dis")+".png",alt:""},on:{click:e.toggleCamera}})]),e._v(" "),n("div",{staticClass:"flex-center"},[n("img",{attrs:{src:"static/mic"+(e.enableMic?"":"-dis")+".png",alt:""},on:{click:e.toggleMic}})]),e._v(" "),n("div",{staticClass:"flex-center"},[n("img",{attrs:{src:"static/screen"+(e.enableScreen?"":"-dis")+".png",alt:""},on:{click:e.toggleScreen}})])])])};j._withStripped=!0;var q={render:j,staticRenderFns:[]},W=q;var D=!1;var H=n("VU/8")(Z,W,!1,function(e){D||n("vZf/")},"data-v-7030392a",null);H.options.__file="src/components/room.vue";var L=H.exports,B=function(){var e=this.$createElement;this._self._c;return this._m(0)};B._withStripped=!0;var G={render:B,staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"template-view"},[t("button",{staticClass:".btn"},[this._v("Get Method")])])}]},T=G;var Q=!1;var K=n("VU/8")({name:"template",components:{},data:function(){return{show:!1}},methods:{}},T,!1,function(e){Q||n("p+W8")},"data-v-2f56c616",null);K.options.__file="src/pages/test.vue";var X=K.exports;o.a.use(m.a);var Y=new m.a({routes:[{path:"/",name:"index",component:g},{path:"/room",name:"room",component:L},{path:"/test",name:"test",component:X}]});n("MGcz");o.a.config.productionTip=!1,o.a.use(i.a),new o.a({el:"#app",router:Y,components:{App:d},template:"<App/>"})},0:function(e,t){},EIJB:function(e,t){},HnCy:function(e,t){},MGcz:function(e,t){},"p+W8":function(e,t){},"vZf/":function(e,t){}},["/5hJ"]);
//# sourceMappingURL=app.eef9063d8318cb1a4e65.js.map