(function(e){function t(t){for(var n,r,s=t[0],c=t[1],l=t[2],d=0,u=[];d<s.length;d++)r=s[d],i[r]&&u.push(i[r][0]),i[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);m&&m(t);while(u.length)u.shift()();return a.push.apply(a,l||[]),o()}function o(){for(var e,t=0;t<a.length;t++){for(var o=a[t],n=!0,r=1;r<o.length;r++){var s=o[r];0!==i[s]&&(n=!1)}n&&(a.splice(t--,1),e=c(c.s=o[0]))}return e}var n={},r={app:0},i={app:0},a=[];function s(e){return c.p+"js/"+({docx:"docx"}[e]||e)+"."+{docx:"931a19ff"}[e]+".js"}function c(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,c),o.l=!0,o.exports}c.e=function(e){var t=[],o={docx:1};r[e]?t.push(r[e]):0!==r[e]&&o[e]&&t.push(r[e]=new Promise(function(t,o){for(var n="css/"+({docx:"docx"}[e]||e)+"."+{docx:"d040b4b9"}[e]+".css",i=c.p+n,a=document.getElementsByTagName("link"),s=0;s<a.length;s++){var l=a[s],d=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(d===n||d===i))return t()}var u=document.getElementsByTagName("style");for(s=0;s<u.length;s++){l=u[s],d=l.getAttribute("data-href");if(d===n||d===i)return t()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=t,m.onerror=function(t){var n=t&&t.target&&t.target.src||i,a=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");a.request=n,delete r[e],m.parentNode.removeChild(m),o(a)},m.href=i;var f=document.getElementsByTagName("head")[0];f.appendChild(m)}).then(function(){r[e]=0}));var n=i[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise(function(t,o){n=i[e]=[t,o]});t.push(n[2]=a);var l,d=document.createElement("script");d.charset="utf-8",d.timeout=120,c.nc&&d.setAttribute("nonce",c.nc),d.src=s(e),l=function(t){d.onerror=d.onload=null,clearTimeout(u);var o=i[e];if(0!==o){if(o){var n=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src,a=new Error("Loading chunk "+e+" failed.\n("+n+": "+r+")");a.type=n,a.request=r,o[1](a)}i[e]=void 0}};var u=setTimeout(function(){l({type:"timeout",target:d})},12e4);d.onerror=d.onload=l,document.head.appendChild(d)}return Promise.all(t)},c.m=e,c.c=n,c.d=function(e,t,o){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(c.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(o,n,function(t){return e[t]}.bind(null,n));return o},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],d=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var m=d;a.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"034f":function(e,t,o){"use strict";var n=o("64a9"),r=o.n(n);r.a},"0a2b":function(e,t,o){"use strict";var n=o("9bed"),r=o.n(n);r.a},1:function(e,t){},"208f":function(e,t,o){"use strict";var n=o("33d6"),r=o.n(n);r.a},"2b33":function(e,t,o){"use strict";var n=3104114736;e.exports={appid:n,_config:{appid:n,idName:"v"+(new Date).getTime(),idAudioName:"a"+(new Date).getTime(),nickName:"u"+(new Date).getTime(),server:"wss://wsliveroom"+n+"-api.zego.im:8282/ws",logLevel:2,logUrl:"",remoteLogLevel:0,audienceCreateRoom:!0},_otherConfig:{cgi_token:"",roomlist:"",signal:"",token:"https://wsliveroom-demo.zego.im:8282/token"}}},"33d6":function(e,t,o){},"56d7":function(e,t,o){"use strict";o.r(t);o("cadf"),o("551c"),o("097d");var n=o("2b0e"),r=o("28dd"),i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[o("router-view")],1)},a=[],s={name:"App"},c=s,l=(o("034f"),o("2877")),d=Object(l["a"])(c,i,a,!1,null,null,null),u=d.exports,m=o("8c4f"),f=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"container"},[e._m(0),o("div",{staticClass:"flex"},[o("div",[o("div",[o("h2",[e._v("加入一场会议")]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.room,expression:"room"}],attrs:{type:"number",placeholder:"会议编号",required:""},domProps:{value:e.room},on:{input:function(t){t.target.composing||(e.room=t.target.value)}}}),o("p",{class:e.validate?"":"error"},[e._v("会议编号是6位数字")]),o("button",{on:{click:e.joinRoom}},[e._v("加入")])])]),o("div",[o("div",[o("h2",[e._v("发起一场会议")]),o("div",{staticClass:"radio"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.video,expression:"video"}],attrs:{type:"radio",id:"open",value:"1"},domProps:{checked:e._q(e.video,"1")},on:{change:function(t){e.video="1"}}}),o("label",{attrs:{for:"open"}},[e._v("视频开启")])]),o("div",{staticClass:"radio"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.video,expression:"video"}],attrs:{type:"radio",id:"close",value:"0"},domProps:{checked:e._q(e.video,"0")},on:{change:function(t){e.video="0"}}}),o("label",{attrs:{for:"close"}},[e._v("视频关闭")])]),o("button",{on:{click:e.createRoom}},[e._v("发起")])])])])])},p=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"flex-center logo"},[o("img",{attrs:{src:"static/logo.png",alt:""}})])}],v=o("a3be"),h={name:"index",data:function(){return{room:"",video:1,validate:!0}},computed:{isSafariOnIphone:function(){var e=window.navigator.userAgent;return-1!=e.indexOf("Safari")&&-1!=e.indexOf("Version")&&-1!=e.indexOf("iPhone")}},methods:{joinRoom:function(){var e=this,t=/^^[1-9]\d{5}$$/;t.test(this.room)?this.$http.get("".concat(v.url,"/conference/isRoomExist"),{params:{roomID:this.room}}).then(function(t){if(!t.data)return alert("该会议编号（".concat(e.room,"）不存在，请检查一下是否有误？"));e.$router.push({name:"room",query:{room:e.room},params:{isSafariOnIphone:e.isSafariOnIphone}})}):this.validate=!1},createRoom:function(){var e,t=!0;while(t)e=Math.floor(1e6*Math.random()),e>1e5&&(t=!1);this.$http.post("".concat(v.url,"/conference/addRoom"),{roomID:e}),this.$router.push({name:"room",query:{room:e,video:this.video},params:{isSafariOnIphone:this.isSafariOnIphone}})}}},g=h,b=(o("0a2b"),Object(l["a"])(g,f,p,!1,null,"c72bf154",null)),w=b.exports,y=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"container flex"},[o("div",{staticClass:"room",class:e.lengthOfRemoteVideo<=3?"":"scroll"},[o("div",{staticClass:"video flex-center",class:e.previewVideo?"":"opacity55"},[o("video",{directives:[{name:"show",rawName:"v-show",value:e.previewVideo,expression:"previewVideo"}],attrs:{id:"previewVideo",muted:"",autoplay:"",playsinline:"",controls:""},domProps:{muted:!0}})]),e._l(e.remoteVideo,function(t,n){return o("div",{directives:[{name:"show",rawName:"v-show",value:n<e.lengthOfRemoteVideo,expression:"i<lengthOfRemoteVideo"}],key:n,staticClass:"video flex-center",class:t?"":"opacity55"},[o("video",{directives:[{name:"show",rawName:"v-show",value:t,expression:"r"}],staticClass:"remoteVideo",attrs:{autoplay:"",playsinline:"",controls:""}})])})],2),o("div",{staticClass:"bottom"},[o("div",[o("div",{on:{click:e.toggleCamera}},[o("img",{attrs:{src:"static/camera.png",alt:""}}),o("div",{staticClass:"circle"},[o("i",{class:e.enableCamera?"green":"red"}),e._v("\n                    "+e._s(e.enableCamera?"关闭视频":"开启视频")+"\n                ")])]),o("div",{on:{click:e.toggleMic}},[o("img",{attrs:{src:"static/mic.png",alt:""}}),o("div",{staticClass:"circle"},[o("i",{class:e.enableMic?"green":"red"}),e._v("\n                    "+e._s(e.enableMic?"关闭声音":"开启声音")+"\n                ")])]),e.isSupportShareScreen?o("div",{on:{click:e.toggleScreen}},[o("img",{attrs:{src:"static/screen"+(e.enableScreen?"-dis":"")+".png",alt:""}}),e._v("\n                "+e._s(e.enableScreen?"关闭分享":"屏幕分享")+"\n            ")]):e._e()]),o("div",[o("div",{on:{click:e.copyToClipboard}},[o("img",{attrs:{src:"static/link.png",alt:""}}),e._v("\n                复制链接\n            ")]),e._m(0),o("div",{staticClass:"red",on:{click:function(t){e.endMeeting()}}},[o("img",{attrs:{src:"static/end-meeting.png",alt:""}}),e._v("\n                结束会议\n            ")]),o("div",[o("span",{staticClass:"flex-center"},[e._v(e._s(e.room))]),e._v("\n                会议编号\n            ")])]),o("div",{staticClass:"none"},[o("audio",{attrs:{id:"screenAudio",autoplay:"",muted:"",playsinline:""}}),e._l(e.remoteVideo,function(e,t){return o("audio",{key:t,staticClass:"remoteAudio",attrs:{autoplay:"",playsinline:""}})})],2)])])},S=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("img",{attrs:{src:"static/invite.png",alt:""}}),e._v("\n                邀请朋友\n            ")])}],_=o("f499"),x=o.n(_),C=(o("ac6a"),o("2b33"));function O(){var e=window.navigator.userAgent,t=void 0!=window.ActiveXObject&&-1!=e.indexOf("MSIE"),o=-1!=e.indexOf("Firefox"),n=void 0!=window.opr,r=e.indexOf("Chrome")&&window.chrome,i=-1!=e.indexOf("Safari")&&-1!=e.indexOf("Version");return t?"IE":o?"Firefox":n?"Opera":r?"Chrome":i?"Safari":"Unkown"}function k(){for(var e=navigator.userAgent,t=new Array("Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"),o=!0,n=0;n<t.length;n++)if(e.indexOf(t[n])>0){o=!1;break}return o}function P(){A.enumDevices(function(e){console.log("enumDevices",e),R=e},function(e){console.error("enum device error: "+e)})}var A,M,N,V,j,E,R,I,$,T=C._config,q=C._otherConfig,D=!1,F=!1,B=[],U=[];function z(){console.info("leave room  and close stream"),F&&(A.stopPreview(M),A.stopPublishingStream(T.idName),F=!1);for(var e=0;e<B.length;e++)A.stopPlayingStream(B[e].stream_id);for(var t=0;t<U.length;t++)A.stopPlayingStream(U[t].stream_id);B=[],U=[],A.logout()}function L(){var e={onStreamUpdated:function(e,t){if(console.log("onStreamUpdated",e,t),0==e){for(var o=B.length,n=U.length,r=0,i=0,a=0;a<t.length;a++)console.info(t[a].stream_id+" was added"),"v"===t[a].stream_id.charAt(0)?(B.push(t[a]),oe(t[a].stream_id,V[o+r]),r++):(U.push(t[a]),ne(t[a].stream_id,j[n+i]),i++);$(o+r)}else if(1==e){for(var s=!1,c=0;c<B.length;c++)for(var l=0;l<t.length;l++)if(B[c].stream_id===t[l].stream_id){A.stopPlayingStream(B[c].stream_id),console.info(B[c].stream_id+" was devared"),B.splice(c,1),s=!0;break}s&&H();for(var d=!1,u=0;u<U.length;u++)for(var m=0;m<t.length;m++)if(U[u].stream_id===t[m].stream_id){A.stopPlayingStream(U[u].stream_id),console.info(U[u].stream_id+" was devared"),U.splice(u,1),d=!0;break}d&&X()}}};for(var t in e)A[t]=e[t]}function Z(){A=new window.ZegoClient,A.setUserStateUpdate(!0),console.log(T),A.config(T),P(),L()}function J(e,t,o,r,i,a,s){M=o,V=r,j=i,I=a,$=s,e?(E&&A.stopScreenShot(),n["a"].http.get(q.token,{params:{app_id:T.appid,id_name:T.idName,cgi_token:q.cgi_token}}).then(function(o){console.log("gettoken success"),Q(e,o.data,t)})):alert("请输入房间号")}function Q(e,t,o){A.login(e,o,t,function(e){console.log("login success"),G(e,o)},function(e){W(e)})}function W(e){alert("登录失败"),console.error(e)}function H(){for(var e=B.length,t=0;t<e;t++)A.stopPlayingStream(B[t].stream_id);for(var o=0;o<e;o++)oe(B[o].stream_id,V[o]);$(e)}function X(){for(var e=U.length,t=0;t<e;t++)A.stopPlayingStream(U[t].stream_id);for(var o=0;o<e;o++)ne(U[o].stream_id,j[o])}function G(e,t){var o=20;if(e.length>=o)return alert("房间太拥挤，换一个吧！"),void z();e.forEach(function(e){"v"===e.stream_id.charAt(0)?B.push(e):U.push(e)}),H(),X(),console.log("login success"),D=!0,1===t&&K()}function K(e){var t=2,o={audio:!0,audioInput:R.microphones[0].deviceId||null,video:!0,facingMode:"user",videoQuality:1*t,horizontal:!0,externalCapture:!1,externalMediaStream:null};o=n["a"].util.extend(o,e),console.log("previewConfig",o);var r=A.startPreview(M,o,function(){console.log("preview success"),I(),F=!0,ee(),P()},function(e){alert(x()(e)),console.error("preview failed",e)});r||alert("预览失败！")}function Y(e){var t=2,o={audio:!0,audioInput:R.microphones[0].deviceId||null,video:!1,videoInput:R.cameras[0].deviceId||null,videoQuality:1*t,horizontal:!0,externalCapture:!1,externalMediaStream:null};o=n["a"].util.extend(o,e),console.log("previewConfig",o),N=document.getElementById("screenAudio"),N.muted=!0;var r=A.startPreview(N,o,function(){console.log("preview audio success"),te()},function(e){alert(x()(e)),console.error("preview failed",e)});r||alert("预览失败！")}function ee(){A.startPublishingStream(T.idName,M)}function te(){A.startPublishingStream(T.idAudioName,N)}function oe(e,t){var o=A.startPlayingStream(e,t);t.muted=!1,o||(alert("哎呀，播放失败啦"),t.style="display:none")}function ne(e,t){var o=A.startPlayingStream(e,t,null,{playType:"audio"});t.muted=!1,o||(alert("哎呀，播放失败啦"),t.style="display:none")}function re(e){A.enableCamera(M,e)}function ie(e){A.enableMicrophone(M,e)}var ae=k()&&("Chrome"===O()||"Firefox"===O());function se(e){e?(D&&A.stopPublishingStream(T.idName),D&&A.stopPreview(M),"Firefox"===O()&&A.startScreenShotFirFox("window",!1,function(e,t){console.log("startScreenShot:"+e),E=e,M.srcObject=t,D&&(K({externalMediaStream:null,width:640,height:480,frameRate:15,bitRate:1e3}),Y({audio:!1}))}),"Chrome"===O()&&A.startScreenShotChrome(function(e,t){console.log("startScreenShot:"+e),E=e,M.srcObject=t,D&&(K({externalCapture:!0,audio:!1}),Y())})):(A.stopScreenShot(),A.stopPreview(M),A.stopPublishingStream(T.idName),K(),A.stopPreview(N),A.stopPublishingStream(T.idAudioName))}console.log("sdk version is",window.ZegoClient.getCurrentVersion()),window.ZegoClient.isSupportWebrtc()?window.ZegoClient.isSupportH264(function(e){Z(),e||alert("浏览器不支持视频h264编码，不能推拉音频流")},function(e){console.error(e)}):alert("浏览器不支持webrtc，换一个浏览器试试吧");var ce={zg:A,openRoom:J,enableCamera:re,enableMicrophone:ie,isSupportShareScreen:ae,enableScreen:se,leaveRoom:z},le=o("a3be"),de={name:"room",data:function(){return{previewVideo:!1,remoteVideo:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],lengthOfRemoteVideo:0,enableCamera:!0,enableMic:!0,enableScreen:!1}},beforeCreate:function(){this.$route.params.isSafariOnIphone&&location.reload(!0)},mounted:function(){var e=this;ce.openRoom(this.room,1,document.getElementById("previewVideo"),document.querySelectorAll(".remoteVideo"),document.querySelectorAll(".remoteAudio"),function(){e.previewVideo=!0,"0"===e.$route.query.video&&e.toggleCamera()},function(t){e.lengthOfRemoteVideo=t;for(var o=0;o<e.remoteVideo.length;o++)e.remoteVideo.splice(o,1,o<t)})},computed:{room:function(){return this.$route.query.room+""},isSupportShareScreen:function(){return ce.isSupportShareScreen}},methods:{toggleCamera:function(){this.enableCamera=!this.enableCamera,ce.enableCamera(this.enableCamera)},toggleMic:function(){this.enableMic=!this.enableMic,ce.enableMicrophone(this.enableMic)},toggleScreen:function(){this.enableScreen=!this.enableScreen,ce.enableScreen(this.enableScreen)},copyToClipboard:function(){var e="您好，快来加入视频会议吧，我在这儿等你："+location.origin+"#/room?room="+this.room,t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),alert("会议的链接已经复制到剪贴板，请通过邮件，微信等发送给他人即可加入该会议。")},endMeeting:function(){ce.leaveRoom(),this.lengthOfRemoteVideo||this.$http.post("".concat(le.url,"/conference/removeRoom"),{roomID:this.room}),this.$router.push({name:"index"})}}},ue=de,me=(o("208f"),Object(l["a"])(ue,y,S,!1,null,"7c49d0f9",null)),fe=me.exports;n["a"].use(m["a"]);var pe=new m["a"]({mode:"hash",base:"",routes:[{path:"/",name:"index",component:w},{path:"/room",name:"room",component:fe},{path:"/docx",name:"docx",component:function(){return o.e("docx").then(o.bind(null,"10e2"))}}]}),ve=o("9483");Object(ve["a"])("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});o("e008");n["a"].config.productionTip=!1,n["a"].use(r["a"]),new n["a"]({router:pe,render:function(e){return e(u)}}).$mount("#app")},"64a9":function(e,t,o){},"9bed":function(e,t,o){},a3be:function(e,t,o){"use strict";e.exports={url:"http://gyj-urwork86851.codeanyapp.com/-api"}},e008:function(e,t,o){}});
//# sourceMappingURL=app.0a03e1b1.js.map